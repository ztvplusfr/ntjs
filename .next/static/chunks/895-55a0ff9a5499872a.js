"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[895],{7:(e,t,r)=>{r.d(t,{default:()=>a});var s=r(2501),o=r(7841);function a(e){let{video:t,movie:r,allVideos:a}=e,[i,n]=(0,o.useState)(!0),[c,l]=(0,o.useState)(null),[d,p]=(0,o.useState)(""),u=(0,o.useRef)(null);(0,o.useEffect)(()=>{if(1===t.play&&"mediaSession"in navigator&&u.current){var e,s;let t=navigator.mediaSession;t.metadata=new MediaMetadata({title:"series"===r.type?"".concat(r.seriesName||r.title," - S").concat(null==(e=r.season)?void 0:e.toString().padStart(1,"0"),"E").concat(null==(s=r.episode)?void 0:s.toString().padStart(1,"0")," - ").concat(r.episodeTitle||"\xc9pisode sans titre"):r.title,artist:"series"===r.type?r.seriesName||r.title:"",album:"series"===r.type?"Saison ".concat(r.season):"",artwork:[{src:"series"===r.type?r.seriesPoster||r.poster||"/placeholder-poster.jpg":r.poster||"/placeholder-poster.jpg",sizes:"96x96",type:"image/jpeg"},{src:"series"===r.type?r.seriesPoster||r.poster||"/placeholder-poster.jpg":r.poster||"/placeholder-poster.jpg",sizes:"128x128",type:"image/jpeg"},{src:"series"===r.type?r.seriesPoster||r.poster||"/placeholder-poster.jpg":r.poster||"/placeholder-poster.jpg",sizes:"192x192",type:"image/jpeg"},{src:"series"===r.type?r.seriesPoster||r.poster||"/placeholder-poster.jpg":r.poster||"/placeholder-poster.jpg",sizes:"256x256",type:"image/jpeg"},{src:"series"===r.type?r.seriesPoster||r.poster||"/placeholder-poster.jpg":r.poster||"/placeholder-poster.jpg",sizes:"384x384",type:"image/jpeg"},{src:"series"===r.type?r.seriesPoster||r.poster||"/placeholder-poster.jpg":r.poster||"/placeholder-poster.jpg",sizes:"512x512",type:"image/jpeg"}]}),t.setActionHandler("play",()=>{var e;null==(e=u.current)||e.play()}),t.setActionHandler("pause",()=>{var e;null==(e=u.current)||e.pause()}),t.setActionHandler("seekbackward",e=>{u.current&&e.seekTime&&(u.current.currentTime=Math.max(0,u.current.currentTime-e.seekTime))}),t.setActionHandler("seekforward",e=>{u.current&&e.seekTime&&u.current.duration&&(u.current.currentTime=Math.min(u.current.duration,u.current.currentTime+e.seekTime))}),t.setActionHandler("seekto",e=>{u.current&&void 0!==e.seekTime&&(u.current.currentTime=e.seekTime)}),t.setActionHandler("previoustrack",()=>{window.history.back()}),t.setActionHandler("nexttrack",()=>{});let o=()=>{u.current&&(t.playbackState=u.current.paused?"paused":"playing")},a=u.current;return a.addEventListener("play",o),a.addEventListener("pause",o),a.addEventListener("ended",o),()=>{a.removeEventListener("play",o),a.removeEventListener("pause",o),a.removeEventListener("ended",o),t.setActionHandler("play",null),t.setActionHandler("pause",null),t.setActionHandler("seekbackward",null),t.setActionHandler("seekforward",null),t.setActionHandler("seekto",null),t.setActionHandler("previoustrack",null),t.setActionHandler("nexttrack",null)}}},[t,r]),(0,o.useEffect)(()=>{let e=(e=>{var t,r;if(e.includes("vidhideplus.com")||e.includes("doodstream"));else if(e.includes("youtube.com")||e.includes("youtu.be")){let r=null==(t=e.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&]+)/))?void 0:t[1];return r?"https://www.youtube.com/embed/".concat(r,"?autoplay=1&rel=0"):e}else if(e.includes("vimeo.com")){let t=null==(r=e.match(/vimeo\.com\/(\d+)/))?void 0:r[1];return t?"https://player.vimeo.com/video/".concat(t,"?autoplay=1"):e}return e})(t.url);p(e);let r=document.createElement("link");return r.rel="preload",r.as="document",r.href=e,document.head.appendChild(r),()=>{document.head.removeChild(r)}},[t.url]);let m=()=>{n(!1),l(null)},h=()=>{l("Impossible de charger la vid\xe9o. Veuillez r\xe9essayer avec une autre source."),n(!1)};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"relative w-full bg-black rounded-lg overflow-hidden",style:{aspectRatio:"16/9"},onContextMenu:e=>e.preventDefault(),onCopy:e=>e.preventDefault(),onCut:e=>e.preventDefault(),onPaste:e=>e.preventDefault(),children:[i&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black z-10",children:(0,s.jsx)("div",{className:"w-12 h-12 border-2 border-red-600 border-t-transparent rounded-full animate-spin"})}),c&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900 z-10",children:(0,s.jsxs)("div",{className:"text-center max-w-md",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-red-600/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-red-500",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})})}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Erreur de chargement"}),(0,s.jsx)("p",{className:"text-gray-400 mb-4",children:c}),(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"R\xe9essayer"})]})}),d&&(0,s.jsx)(s.Fragment,{children:1===t.play?(0,s.jsx)("video",{ref:u,src:t.url,className:"w-full h-full border-0 ".concat(i?"opacity-0":"opacity-100"," transition-opacity duration-200"),autoPlay:!0,playsInline:!0,controls:!0,controlsList:"nodownload",onLoadedData:m,onError:h,onLoadStart:()=>n(!0),onCanPlay:()=>n(!1),onContextMenu:e=>e.preventDefault(),onDragStart:e=>e.preventDefault(),onCopy:e=>e.preventDefault(),onCut:e=>e.preventDefault(),onPaste:e=>e.preventDefault(),title:"Regarder ".concat(r.title," en streaming"),style:{objectFit:"contain",WebkitUserSelect:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none"}}):(0,s.jsx)("iframe",{src:d,className:"w-full h-full border-0 ".concat(i?"opacity-0":"opacity-100"," transition-opacity duration-200"),allowFullScreen:!0,allow:"autoplay; encrypted-media; picture-in-picture; web-share",onLoad:m,onError:h,loading:"eager",title:"Regarder ".concat(r.title," en streaming"),referrerPolicy:"no-referrer-when-downgrade"})})]}),(0,s.jsx)("div",{className:"bg-gray-900 rounded-lg p-3",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-6 h-6 bg-red-600 rounded flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M8 5v14l11-7z"})})}),(0,s.jsx)("span",{className:"font-medium text-sm",children:t.name})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-xs",children:[(0,s.jsx)("span",{className:"px-2 py-1 rounded ".concat("1080p"===t.quality?"bg-blue-600 text-white":"bg-gray-700 text-gray-300"),children:t.quality}),(0,s.jsx)("span",{className:"px-2 py-1 bg-gray-700 rounded text-gray-300",children:t.lang}),(0,s.jsx)("span",{className:"px-2 py-1 rounded ".concat(1===t.pub?"bg-red-600/20 text-red-400":"bg-green-600/20 text-green-400"),children:1===t.pub?"Avec pub":"Sans pub"}),(0,s.jsx)("span",{className:"px-2 py-1 rounded ".concat(1===t.play?"bg-blue-600/20 text-blue-400":"bg-purple-600/20 text-purple-400"),children:1===t.play?"Natif":"Externe"})]})]}),a.length>1&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"Qualit\xe9:"}),(0,s.jsx)("div",{className:"flex space-x-1",children:a.filter(e=>e!==t).slice(0,2).map((e,t)=>(0,s.jsx)("a",{href:"/watch/".concat(r.id,"?server=").concat(encodeURIComponent(e.name),"&quality=").concat(e.quality,"&lang=").concat(e.lang),className:"px-2 py-1 bg-gray-800 hover:bg-gray-700 rounded text-xs transition-colors",children:e.quality},t))})]})]})})]})}},1296:(e,t,r)=>{function s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)e[s]=r[s]}return e}r.d(t,{A:()=>o});var o=function e(t,r){function o(e,o,a){if("undefined"!=typeof document){"number"==typeof(a=s({},r,a)).expires&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var n in a)a[n]&&(i+="; "+n,!0!==a[n]&&(i+="="+a[n].split(";")[0]));return document.cookie=e+"="+t.write(o,e)+i}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],s={},o=0;o<r.length;o++){var a=r[o].split("="),i=a.slice(1).join("=");try{var n=decodeURIComponent(a[0]);if(s[n]=t.read(i,n),e===n)break}catch(e){}}return e?s[e]:s}},remove:function(e,t){o(e,"",s({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,s({},this.attributes,t))},withConverter:function(t){return e(s({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},1910:(e,t,r)=>{r.d(t,{a:()=>a});var s=r(1296);let o={expires:365,secure:!0,sameSite:"strict",domain:void 0},a={getWatchHistory:()=>{try{let e=s.A.get("watch-history");return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing watch history from cookie:",e),[]}},setWatchHistory:e=>{try{s.A.set("watch-history",JSON.stringify(e),o)}catch(e){console.error("Error saving watch history to cookie:",e)}},addToWatchHistory:e=>{let t=a.getWatchHistory().filter(t=>!(t.id===e.id&&(!e.episode||t.episode&&t.episode.season===e.episode.season&&t.episode.episode===e.episode.episode))),r=[e,...t].slice(0,50);a.setWatchHistory(r)},removeFromWatchHistory:(e,t)=>{let r=a.getWatchHistory().filter(r=>!(r.id===e&&(!t||r.episode&&r.episode.season===t.season&&r.episode.episode===t.episode)));a.setWatchHistory(r)},clearWatchHistory:()=>{s.A.remove("watch-history")},getSeriesPreferences:e=>{try{let t=s.A.get("series-".concat(e,"-preferences"));return t?JSON.parse(t):null}catch(e){return console.error("Error parsing series preferences from cookie:",e),null}},setSeriesPreferences:(e,t)=>{try{s.A.set("series-".concat(e,"-preferences"),JSON.stringify(t),o)}catch(e){console.error("Error saving series preferences to cookie:",e)}},migrateFromLocalStorage:()=>{try{let e=localStorage.getItem("watch-history");e&&!s.A.get("watch-history")&&(s.A.set("watch-history",e,o),localStorage.removeItem("watch-history")),Object.keys(localStorage).forEach(e=>{if(e.startsWith("series-")&&e.endsWith("-preferences")){let t=localStorage.getItem(e);t&&(s.A.set(e,t,o),localStorage.removeItem(e))}}),localStorage.getItem("watchHistory")&&localStorage.removeItem("watchHistory")}catch(e){console.error("Error during migration from localStorage:",e)}}}},9289:(e,t,r)=>{r.d(t,{default:()=>a});var s=r(7841),o=r(1910);function a(e){let{type:t,movie:r,series:a,season:i,episode:n,episodeTitle:c,video:l}=e;return(0,s.useEffect)(()=>{let e=(e,t,r,s,a,i)=>{var n;let c=new Date,l=async(e,t)=>{try{let r="series"===t?"tv":"movie",s=await fetch("https://api.themoviedb.org/3/".concat(r,"/").concat(e,"?api_key=").concat("f3d757824f08ea2cff45eb8f47ca3a1e","&language=fr-FR&append_to_response=images"),{cache:"no-store"});if(s.ok){let e=await s.json();if(e.backdrop_path)return"https://image.tmdb.org/t/p/w780".concat(e.backdrop_path)}let o=await fetch("https://api.themoviedb.org/3/".concat(r,"/").concat(e,"?api_key=").concat("f3d757824f08ea2cff45eb8f47ca3a1e","&language=en-US&append_to_response=images"),{cache:"no-store"});if(o.ok){let e=await o.json();if(e.backdrop_path)return"https://image.tmdb.org/t/p/w780".concat(e.backdrop_path)}}catch(e){console.error("Error fetching backdrop from TMDB:",e)}},d={type:e,id:t.id,title:"series"===e?t.name:t.title,poster:(n=t.poster_path)?"https://image.tmdb.org/t/p/w500".concat(n):"/placeholder-poster.jpg",backdrop:t.backdrop_path?"https://image.tmdb.org/t/p/w780".concat(t.backdrop_path):void 0,timestamp:c.getTime(),date:c.toLocaleDateString("fr-FR"),time:c.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),season:r,episode:s,episodeTitle:a,video:i?{id:i.id,hasAds:i.hasAds,lang:i.lang,pub:i.pub,quality:i.quality,server:i.server,url:i.url,serverIndex:i.serverIndex}:void 0};console.log("Creating history item with data:",{itemType:e,itemData:t,seasonData:r,episodeData:s,episodeTitleData:a,videoData:i,historyItem:d}),!d.backdrop&&t.id&&l(t.id,e).then(a=>{if(a){let a=o.a.getWatchHistory().map(o=>{var a,i;return o.id===t.id&&o.type===e&&(null==(a=o.episode)?void 0:a.season)===r&&(null==(i=o.episode)?void 0:i.episode)===s?{...o,poster:o.poster}:o});o.a.setWatchHistory(a)}});let p=o.a.getWatchHistory().map(e=>{var t,r;return{type:e.type,id:e.id,title:e.title,poster:e.poster||"/placeholder-poster.jpg",backdrop:void 0,timestamp:new Date(e.watchedAt).getTime(),date:new Date(e.watchedAt).toLocaleDateString("fr-FR"),time:new Date(e.watchedAt).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),season:null==(t=e.episode)?void 0:t.season,episode:null==(r=e.episode)?void 0:r.episode,episodeTitle:void 0,video:void 0}}),u=p.find(o=>o.type===e&&o.id===t.id&&o.season===r&&o.episode===s);if(u){let a={...u,video:i?{id:i.id,hasAds:i.hasAds,lang:i.lang,pub:i.pub,quality:i.quality,server:i.server,url:i.url,serverIndex:i.serverIndex}:void 0,timestamp:c.getTime(),date:c.toLocaleDateString("fr-FR"),time:c.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})};console.log("Updating existing history item:",a);let n=[a,...p.filter(o=>o.type!==e||o.id!==t.id||o.season!==r||o.episode!==s)].slice(0,50),l=n.map(e=>({id:e.id,title:e.title,type:e.type,poster:e.poster,episode:e.episode&&e.season?{season:e.season,episode:e.episode}:void 0,watchedAt:new Date(e.timestamp).toISOString(),progress:void 0}));o.a.setWatchHistory(l),console.log("Full history saved (updated):",n);return}let m=[d,...p.filter(o=>o.type!==e||o.id!==t.id||o.season!==r||o.episode!==s)].slice(0,50),h=m.map(e=>({id:e.id,title:e.title,type:e.type,poster:e.poster,episode:e.episode&&e.season?{season:e.season,episode:e.episode}:void 0,watchedAt:new Date(e.timestamp).toISOString(),progress:void 0}));o.a.setWatchHistory(h),console.log("History item saved:",d),console.log("Full history saved:",m)};"movie"===t&&r?e("movie",r,void 0,void 0,void 0,l):"series"===t&&a&&e("series",a,i,n,c,l)},[t,r,a,i,n,c,l]),null}}}]);